<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Fenster Erfassung V3.6</title>

<!-- PWA -->
<meta name="theme-color" content="#0b1220">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icons/icon-192.png">

<!-- Styles -->
<link rel="stylesheet" href="style.css">

<!-- Excel Export Libraries -->
<script src="https://unpkg.com/exceljs@4.4.0/dist/exceljs.min.js"></script>
<script src="https://unpkg.com/file-saver@2.0.5/dist/FileSaver.min.js"></script>

</head>
<body>

<header class="topbar">
  <div class="brand">
    <span class="logo">ðŸªŸ</span>
    <b>Fenster Erfassung</b>
    <small>V3.6</small>
  </div>

  <div class="top-actions">
    <label class="toggle">
      <input id="themeToggle" type="checkbox">
      <span>Light</span>
    </label>

    <label class="toggle">
      <input type="checkbox" id="csvToggle">
      <span>CSV</span>
    </label>

    <button id="exportBtn" class="btn primary">Export</button>
  </div>
</header>


<main class="container">

<!-- =============================== -->
<!--       HAUPTEINSTELLUNGEN        -->
<!-- =============================== -->

<section class="card accent">
  <h2>Haupteinstellungen (Default)</h2>
  <p class="muted">Diese Werte gelten fÃ¼r jede neue Position, kÃ¶nnen aber unten Ã¼berschrieben werden.</p>

  <div class="grid g5">
    <div class="field">
      <label>Einstand links</label>
      <input id="def_Einst_L" type="number" value="10">
    </div>

    <div class="field">
      <label>Einstand rechts</label>
      <input id="def_Einst_R" type="number" value="10">
    </div>

    <div class="field">
      <label>Einstand oben</label>
      <input id="def_Einst_O" type="number" value="10">
    </div>

    <div class="field">
      <label>Einstand unten</label>
      <input id="def_Einst_U" type="number" value="30">
    </div>

    <div class="field">
      <label>Normrahmen (NRa)</label>
      <input id="def_NRa" type="number" value="98">
    </div>
  </div>
</section>




<!-- =============================== -->
<!--       POSITION ERFASSEN         -->
<!-- =============================== -->

<section class="card">

  <div class="heading">
    <h2>Neue Position <span id="posLabel">1</span></h2>
  </div>

  <div class="grid g2">

    <div class="field">
      <label>Foto (optional, in Excel 4Ã—4 cm)</label>
      <input id="cameraInput" type="file" accept="image/*" capture="environment">
      <div id="photoPreview" class="photo">Kein Foto</div>

      <div class="row">
        <button id="acceptPhoto" class="btn primary" disabled>Foto akzeptieren</button>
        <button id="discardPhoto" class="btn ghost" disabled>LÃ¶schen</button>
      </div>
    </div>

    <div class="field">
      <label>Bauposition</label>
      <input id="bauposition" type="text" placeholder="z.B. KÃ¼che">

      <label>Hinweise / Speziell</label>
      <input id="bemerkung" type="text" placeholder="Optional">
    </div>

  </div>


  <h3>Anschlag-Eingabe (nur eines eingeben)</h3>
  <div class="grid g2">
    <div class="field">
      <label>Anschlag links</label>
      <input id="Anschlag_li" type="number" placeholder="nur eines">
    </div>

    <div class="field">
      <label>Anschlag rechts</label>
      <input id="Anschlag_re" type="number" placeholder="nur eines">
    </div>
  </div>


  <h3>Eingaben â€“ Lichtmasse & Referenzen</h3>

  <div class="grid g3">

    <div class="field">
      <label>Futterlicht Breite (FLB)</label>
      <input id="FLB" type="number">
    </div>

    <div class="field">
      <label>Futterlicht HÃ¶he (FLH)</label>
      <input id="FLH" type="number">
    </div>

    <div class="field">
      <label>UK Rahmen â€“ Futterlicht (UKR-FL)</label>
      <input id="UKR_FL" type="number">
    </div>

    <div class="field">
      <label>Rahmenaussenmass HÃ¶he (Eingabe)</label>
      <input id="RAM_H_eingabe" type="number">
    </div>

    <div class="field">
      <label>Rahmenaussenmass Breite (Eingabe)</label>
      <input id="RAM_B_eingabe" type="number">
    </div>

  </div>



  <h3>EinstÃ¤nde anpassen</h3>
  <div class="grid g5">

    <div class="field">
      <label>Einstand links</label>
      <input id="Einst_L" type="number">
    </div>

    <div class="field">
      <label>Einstand rechts</label>
      <input id="Einst_R" type="number">
    </div>

    <div class="field">
      <label>Einstand oben</label>
      <input id="Einst_O" type="number">
    </div>

    <div class="field">
      <label>Einstand unten</label>
      <input id="Einst_U" type="number">
    </div>

    <div class="field">
      <label>Normrahmen (NRa)</label>
      <input id="NRa" type="number">
    </div>

  </div>




  <h3>Berechnete Rahmenbreiten (editierbar)</h3>

  <div class="grid g2 rb-grid">

    <div class="field rb">
      <label>RB_L</label>
      <div class="mm">
        <input id="RB_L" type="number">
        <span>mm</span>
      </div>
    </div>

    <div class="field rb">
      <label>RB_R</label>
      <div class="mm">
        <input id="RB_R" type="number">
        <span>mm</span>
      </div>
    </div>

    <div class="field rb">
      <label>RB_U</label>
      <div class="mm">
        <input id="RB_U" type="number">
        <span>mm</span>
      </div>
    </div>

    <div class="field rb">
      <label>RB_O</label>
      <div class="mm">
        <input id="RB_O" type="number">
        <span>mm</span>
      </div>
    </div>

  </div>



  <div class="calc card soft">
    <h3>Resultate (live)</h3>

    <div class="grid g2">
      <div><b>RL_B:</b> <span id="RL_B">â€“</span> mm</div>
      <div><b>RL_H:</b> <span id="RL_H">â€“</span> mm</div>
      <div><b>RAM_B:</b> <span id="RAM_B">â€“</span> mm</div>
      <div><b>RAM_H:</b> <span id="RAM_H">â€“</span> mm</div>
      <div><b>RV_zu_Norm:</b> <span id="RV_zu_Norm">â€“</span> mm</div>
    </div>
  </div>


  <div class="actions-bottom">
    <button id="saveRow" class="btn primary lg">Position speichern</button>
    <div id="msg" class="msg"></div>
  </div>

</section>




<section class="card">
  <h2>Erfasste Positionen</h2>
  <div id="list" class="list"></div>
</section>

</main>


<footer class="foot">
  <small>Â© BÃ¤rtschi Fenster AG â€“ lokal gespeichert â€¢ PWA</small>
</footer>


<script src="script.js"></script>

<script>
if ("serviceWorker" in navigator) {
  window.addEventListener("load", () => {
    navigator.serviceWorker.register("service-worker.js");
  });
}
</script>

</body>
</html>
